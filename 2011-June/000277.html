<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Slim-dev] [Bug #15539] Expired accounts render slim unusable
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/slim-dev/2011-June/index.html" >
   <LINK REL="made" HREF="mailto:slim-dev%40lists.berlios.de?Subject=Re%3A%20%5BSlim-dev%5D%20%5BBug%20%2315539%5D%20Expired%20accounts%20render%20slim%20unusable&In-Reply-To=%3C201106241914.p5OJECve004203%40unicorn.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000276.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Slim-dev] [Bug #15539] Expired accounts render slim unusable</H1>
    <B>admin at berlios.de</B> 
    <A HREF="mailto:slim-dev%40lists.berlios.de?Subject=Re%3A%20%5BSlim-dev%5D%20%5BBug%20%2315539%5D%20Expired%20accounts%20render%20slim%20unusable&In-Reply-To=%3C201106241914.p5OJECve004203%40unicorn.berlios.de%3E"
       TITLE="[Slim-dev] [Bug #15539] Expired accounts render slim unusable">admin at berlios.de
       </A><BR>
    <I>Fri Jun 24 21:14:12 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000276.html">[Slim-dev] SLIM PAM CK question
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#277">[ date ]</a>
              <a href="thread.html#277">[ thread ]</a>
              <a href="subject.html#277">[ subject ]</a>
              <a href="author.html#277">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Bug #15539, was updated on 2009-Apr-20 18:23
Here is a current snapshot of the bug.

Project: SLiM
Category: to consider
Status: Open
Resolution: None
Bug Group: None
Priority: 5
Submitted by: asgarserran
Assigned to : none
Summary: Expired accounts render slim unusable

Details: Issue: When a user with expired password logs in with slim, he is left with a gray screen. The only escape is to hit ALT+CTRL+Backspace, thus killing / restarting X.

Expected behaviour: The user should be asked to change his passwor.d

Steps to reproduce: As root, expire a user's password (passwd -e user). Log in with slim. (If you are unfamiliar with this, log in on a login shell afterwards and see what happens)

Ways to fix this:
The first possibility, which would be enough for me, would to prevent the user from logging in, instead displaying an error message.
Another possibility would be to ask the user to change his password.

My version of slim is 1.3.1-r4, installed via portage on Gentoo GNU/Linux (x86).

Follow-Ups:

Date: 2011-Jun-24 20:14
By: bdt-rob

Comment:
I have a very simple patch that &quot;fixes&quot; this for 1.3.2-r3 (Gentoo version). I say &quot;fixes&quot; - it results in an attempt to log in an expired user failing exactly the same way a non-existent user does, or a bad password does. The OP's request for an error message seems therefore to be a separate issue....


*** slim-1.3.2-orig/PAM.cpp	Fri Jun 24 19:00:29 2011
--- slim-1.3.2/PAM.cpp	Fri Jun 24 19:28:43 2011
***************
*** 144,151 ****
              //case PAM_NEW_AUTHTOKEN_REQD:
              case PAM_ACCT_EXPIRED:
              case PAM_USER_UNKNOWN:
!                 _end();
!                 throw Exception(pam_handle, &quot;pam_acct_mgmt()&quot;, last_result);
                  
              case PAM_AUTH_ERR:
              case PAM_PERM_DENIED:
--- 144,151 ----
              //case PAM_NEW_AUTHTOKEN_REQD:
              case PAM_ACCT_EXPIRED:
              case PAM_USER_UNKNOWN:
! //                _end();
! //                throw Exception(pam_handle, &quot;pam_acct_mgmt()&quot;, last_result);
                  
              case PAM_AUTH_ERR:
              case PAM_PERM_DENIED:

-------------------------------------------------------

For detailed info, follow this link:
<A HREF="http://developer.berlios.de/bugs/?func=detailbug&amp;bug_id=15539&amp;group_id=2663">http://developer.berlios.de/bugs/?func=detailbug&amp;bug_id=15539&amp;group_id=2663</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000276.html">[Slim-dev] SLIM PAM CK question
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#277">[ date ]</a>
              <a href="thread.html#277">[ thread ]</a>
              <a href="subject.html#277">[ subject ]</a>
              <a href="author.html#277">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/slim-dev">More information about the Slim-dev
mailing list</a><br>
</body></html>
